require(["require","jquery","routing","bootstrap"],function(a,b,c){function d(a){h.empty(),a&&(h.append(i),b.ajax({url:c.generate("ekyna_setting_api_helper_fetch"),data:{reference:a},type:"GET",dataType:"xml"}).done(function(a){i.remove();var c=b(a).find("content");if(1===c.length){var d=b("<div />");b(c.text()).appendTo(d),d.appendTo(h)}}).always(function(){i.remove()}))}b("#sidebar-menu").on("click",".dropdown-toggle",function(a){a.preventDefault();var c=b(this).parent();c.toggleClass("active"),c.hasClass("active")?c.find(".submenu").slideDown("fast"):c.find(".submenu").slideUp("fast")});var e=b("#sidebar-nav");b("body").click(function(){b(this).hasClass("menu")&&b(this).removeClass("menu")}),e.click(function(a){a.stopPropagation()}),b("#menu-toggler").click(function(a){a.stopPropagation(),b("body").toggleClass("menu")}),b(window).resize(function(){b(this).width()>769&&b("body.menu").removeClass("menu")}),e.height()>b(".content").height()&&b("html").addClass("small"),b(document).on("click",".nav-tabs a",function(a){a.preventDefault(),b(this).tab("show")});var f=b("form");f.size()>0&&a(["ekyna-form"],function(a){f.each(function(b,c){var d=a.create(c);d.init()})});var g=b(".ekyna-table");g.size()>0&&a(["ekyna-table"],function(a){g.each(function(b,c){a.create(c)})}),b(document).on("click","a[data-toggle-details]",function(a){a.preventDefault();var c=b(this),d=b("#"+c.data("toggle-details"));return 1===d.size()&&(d.is(":visible")?d.hide():d.show()),!1}),b(document).on("click","a.user-pin",function(a){a.preventDefault();var d=b(this),e=b(".navbar li.user-pins > div"),f=d.attr("href");return b.ajax({url:f,method:"GET",dataType:"json"}).done(function(a){if(a.hasOwnProperty("added")){var f=b('<span data-id="'+a.added.id+'"></span>'),g=b('<a href="'+a.added.path+'">'+a.added.label+"</a>"),h='<a href="'+c.generate("ekyna_admin_pin_remove",{id:a.added.id})+'"><i class="fa fa-remove"></i></a>';f.append(g).append(h).prependTo(e),d.addClass("unpin").attr("href",c.generate("ekyna_admin_pin_resource_unpin",{name:a.added.resource,identifier:a.added.identifier}))}else a.hasOwnProperty("removed")&&(e.find("span[data-id="+a.removed.id+"]").remove(),d.addClass("unpin").attr("href",c.generate("ekyna_admin_pin_resource_pin",{name:a.removed.resource,identifier:a.removed.identifier})))}),!1}),b("li.user-pins").on("click","a:last-child",function(a){a.preventDefault();var c=b(this),d=c.attr("href");return b.ajax({url:d,method:"GET"}).done(function(){c.parent().remove()}),!1});var h=b("#helper-content:visible"),i=b('<p id="helper-content-loading"><i class="fa fa-spinner fa-spin fa-2x"></i></p>');if(1===h.length){var j=h.data("helper")||null;d(j),f.on("focus","*[data-helper]",function(){d(b(this).data("helper"))}).on("blur","*[data-helper]",function(){d(j)})}});