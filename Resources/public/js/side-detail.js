define(["jquery","routing","bootstrap"],function(a,o){var i={$container:null,load:function(t){var i=this;if(t.data("side-detail-content"))i.open(t);else{var e,n=t.data("side-detail");if("object"==typeof n)e=o.generate(n.route,n.parameters);else{if("string"!=typeof n)throw"Unexpected summary config.";e=n}n=a.ajax({url:e,dataType:"html"});n.done(function(e){t.data("side-detail-content",e),t.removeData("side-detail-xhr"),i.open(t)}),t.data("side-detail-xhr",n),t.removeData("side-detail-timeout")}},open:function(e){this.$container.addClass("opened").find("> div").html(e.data("side-detail-content"))},close:function(){this.$container.removeClass("opened")},isOpened:function(){return this.$container.hasClass("opened")},lock:function(){this.$container.addClass("locked")},unlock:function(){this.$container.removeClass("locked")},isLocked:function(){return this.$container.hasClass("locked")},init:function(){"ontouchstart"in window||(this.$container=a('<div id="side-detail"><span><i class="glyphicon glyphicon-pushpin"/></span><div></div></div>').appendTo("body"),a(document).on("mouseenter","[data-side-detail]",function(e){var t;i.isLocked()||((t=a(e.currentTarget)).data("side-detail-xhr")||t.data("side-detail-timeout")||t.data("side-detail-timeout",setTimeout(function(){i.load(t)},300)))}).on("mouseleave","[data-side-detail]",function(e){var t;i.isLocked()||((e=a(e.currentTarget)).data("side-detail-xhr")||(t=e.data("side-detail-timeout"),clearTimeout(t),e.removeData("side-detail-timeout"),i.close()))}).on("keyup",function(e){17===e.which?i.isLocked()?i.unlock():i.isOpened()&&i.lock():27===e.which&&(i.isLocked()&&i.unlock(),i.isOpened()&&i.close())}))}};return i});